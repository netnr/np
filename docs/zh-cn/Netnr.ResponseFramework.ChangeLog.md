# 更新日志

### [更新日志已迁移](CHANGELOG.md)

### [v3.1.5] - 2020-06-14
- 优化 配置菜单链接无须小写（但建议统一小写）
- 添加 后台校验角色是否能访问已加入菜单表的链接

### [v3.1.4] - 2020-05-18
- 调整 项目结构
- 修复 页面删除方法 `POST` 请求改为 `GET`
- 调整 `init.js` 方法名称；标签选项卡 A标签链接为 `iframe` 地址，方便右键新窗口打开
- 调整 日志表添加 `User-Agent`，引入 `DeviceDetector.NET` 组件，更好的解析客户端的 **操作系统**、**浏览器** 信息
- 调整 表管理 使用 `Netnr.DataKit` 项目提供服务

### [v3.1.3] - 2020-04-26
- 调整 项目结构

### [v3.1.2] - 2020-04-18
- 调整 组件CDN源
- 调整 升级引用包

### [v3.1.1] - 2019-12-22
- 调整 数据库上下文改为连接池托管
- 调整 IP地址查询 改为 `IP2Region` 组件

### [v3.1.0] - 2019-12-04
- 调整 升级为 `.NET Core 3.1`
- 添加 服务器信息 页面

### [v3.0.1] - 2019-11-13
- 调整 所有非页面请求规范化为接口，并用 swagger 生成可视化接口文档，<https://rf2.netnr.com/swagger>

### [v3.0.0] - 2019-09-29
- 调整 升级为 `.NET Core 3.0`

### [v2.2.10] - 2019-07-23
- 添加 `QueryWhere`针对`IEnumerable`条件查询的方法重载（支持部分查询关系符）
- 调整 表管理支持搜索（基于`IEnumerable`的查询，即内存搜索）
- 调整 日期时间组件，支持 **placeholder** 显示
- 修复 批处理切换方法`z.batchButtonSwitch`逻辑缺陷
- 添加 单据（主从表展示，如：采购订单，更多的组件支持须完善）
- 调整 表单组件传参调整，为兼容单据，即支持模态表单和页面切换单据的生成
- 调整 `z.js` 内部方法构造调整，解决了一些问题
- 调整 引入定时任务组件 **FluentScheduler**
- 添加 自动生成单表增删改查代码（Controller、View、JavaScript）

### [v2.2.9] - 2019-07-05
- 修复 未将定时任务的服务添加到容器，导致定时任务未执行

### [v2.2.8] - 2019-06-25
- 添加 `数据字典`
- 添加 表单嵌入富文本示例（基于 `CKEditor4`，图片支持粘贴、拖拽上传，大小限制 **2MB** ）
- 调整 z.Combo绑定，支持 **placeholder** 显示

### [v2.2.7] - 2019-06-23
- 修复 公共导出（js脚本问题）
- 添加 上传的示例（ajax上传，带上传真实进度条，表格显示格式化，查看文件，必填验证）
- 添加 批量操作示例（依赖 Z.EntityFramework.Extensions）

### [v2.2.6] - 2019-06-14
- 调整 输入输出实体对象名，为公共导出提供支持
- 调整 公共导出查询依赖查询，仅维护一处
- 调整 增删改统一返回格式，维护方法返回对象
- 调整 `appsettings.json` 配置文件设置键名 `TypeDB` 等于数据库类型
- 添加 `PostgreSQL`生成表配置、表信息查询的脚本

### [v2.2.5] - 2019-06-10
- 修复 在linux上导出、文件清理的路径问题
- 修复 内置参数可忽略日志记录的逻辑问题
- 修复 表单编辑，多选下拉列表值为空时赋值了一项空值的问题
- 添加 表配置新增项：表单`maxlength`属性
- 添加 表配置新增项：`查询条件关系符`配置，避免不支持的关系符查询出错
- 添加 Iframe页面`全屏`功能按钮
- 添加 低版本浏览器拦截提示页面
- 添加 下拉列表面板高度自适应
- 调整 DataGrid分页组件不显示调转页，启用快捷页码
- 调整 页面表单配置，拖拽排序的方式从节点交换改为节点插入
- 调整 窗口大小改变时从修改所有iframe标签高度改为仅修改当前iframe标签高度，切换时再触发
- 调整 为更好的自适应效果，iframe标签设置`scrolling="no"`，子页面有需要滚动条显示用`<div class="bodyscroll">`包装，参考桌面页

### [v2.2.4] - 2019-06-02
- 添加 角色添加复制角色权限功能
- 添加 `公共导出`，自定义查询、条件、格式化
- 添加 定时任务，自动重置数据库、清理临时目录
- 添加 表格示例，快捷查询与查询面板共存；注意：启用快捷查询的条件在查询面板中需关闭，避免冲突
- 添加 表格示例，`批量删除`功能示例
- 调整  `批处理`功能按钮优化，批处理状态功能按钮自动切换
- 调整 查询面板 默认关系 从  **等于**  改为  **包含**

### [v2.2.3] - 2019-04-26
- 调整 标签页添加控制菜单
- 调整 圆角调整为`1px`
- 调整 `EasyUI`默认引用`metro`主题
- 调整 静态资源引入由局部视图统一维护
- 添加 日志表添加IP所属的城市，离线查询IP地址，基于免费的`ipip.ipdb`
-  **据群发起投票结果，今后仅更新 `.NET Core` 版本，`.NET4` 停更** 

### [v2.2.2] - 2019-04-18
- 调整 日志分批写入

### [v2.2.1] - 2019-02-28
- 调整 导出 Excel的 `NPOITo` 类，支持 `.xls`、`.xlsx`导出
- 调整 表格查询面板生成模式，基于表格列配置生成，支持多表格查询面板
- 移除 快捷键 `Ctrl + Q` 打开查询面板（因存在多个查询面板）
- 添加 表格列标题快捷打开定位条件查询面板
- 调整 首次运行项目，自动创建数据库、调重置数据库（`scripts/table-reset` 目录需有对应的数据库脚本）
- 修复 datetime日期时间输入类型查询面板赋值存在的问题（没阻止冒泡，先结束编辑再赋值造成赋值失败）
- 调整 `Netnr.Core` 类库项目从NuGet引入，新增 `Netnr.Fast` 项目
- 调整 支持多表单生成（页面的表单、表格配置默认第一个，暂不支持多表单、表格配置）

### [v2.2.0] - 2019-01-17
- 调整 Grid行数可选列表,可选200行
- 修复 多个Grid传参有干扰的问题,修复方式为先清空 `queryparams` 对象
- 调整 去除日期时间插件 `bootstrap-datetimepicker`  改为 `EasyUI` 提供曰期时间组件，减少两次请求
- 添加 Modal弹出窗设置 `autorefresh` 属性，每次打开 `iframe` 自动刷新
- 调整 Moda1弹出窗默认为全屏弹窗
- 调整 表单必填项提示改为红星
- 添加 中文语言包
- 修复 页面嵌套大于两层出现样式不一样的问题,修复方式为把 `parent` 对象改成 `top`
- 调整 `init.css` 样式包嵌入 `z.css`
- 调整 `easel-custom.css` 调整的样式嵌入 `z.css` ,页面直接引入原有包 `easyul.css`
- 调整 表配置隐藏添加系统级隐藏
- 调整 Grid行号宽度自适应
- 修复 切换用户菜单异常的问题，菜单缓存问题，去除了菜单缓存
- 添加 表管理导出 `Excel` 
- 调整 数据库表字段命名，减少关联查询出现重复列的一些问题
- 调整 演示项目数据库从 `MySQL` 迁移到 `SQLServer`,无其他原因，主要是自己用着顺手些
- 调整 查询面板默认关系符为 “等于”，支持快捷键 `Ctrl + Q` 打开查询面板、 `Enter` 确认搜索

### [v2.1.2] - 2018-11-09
- 增加 `.NET Framework 4.5`框架源代码，同步更新Core版本

### [v2.1.2] - 2018-11-01
- 修复 `DataGrid`执行`updateRow`更新有翻页时行号有问题（没设置pageNumber的原因）
- 调整 公共查询的一些操作

### [v2.1.2] - 2018-10-27
- 添加 `按钮管理`功能
- 添加 `菜单管理`功能
- 添加 `授权关联`功能（支持第三方登录）
- 添加 `z.Combo`方法添加清除值按钮支持
- 添加 `PostgreSQL`数据库支持
- 调整 `Linq`查询，可不传排序列，即默认排序
- 调整 选项卡右侧仅为刷新按钮

### [v2.1.1] - 2018-10-13
- 修复 方法`z.FindTreeNode`存在的问题
- 修复 方法`z.FormEdit`存在的问题
- 修复 `Linq`查询先分页后排序的问题
- 修复 系统操作日志，`IP`获取始终为`127.0.0.1`的问题，原因是`nginx`代理，需要判断代理环境

### [v2.1.0]　2018-10
- 添加 跨平台跨数据库支持，<https://github.com/aspnet/EntityFrameworkCore> ，已测试`SQLite`、`MySql`、`SQLServer`
- 生成实体依赖于`Scaffold-DbContext`命令 <https://www.netnr.com/gist/code/5283651389582691979>
- 调整 公共查询从SQL语句改为Linq
- 修复 `z.js`若干问题
- 添加 表管理工具，生成表配置、表字典
- 调整 演示项目调整，从`SQLServer`改为`MySql`，服务器迁移国外搬瓦工（Centos7、Nginx、MySql、CN2线路）
- 
- 顺便说一下这段时间的体会，一直用`Windows`服务器，接触`Linux`后，认为`Linux`做服务器是挺好的，已打算全部迁移至`Linux`服务器。
  -  `Linux`服务器便宜，相对而言
  - 国外的`VPS`大多限流量不限速度（比如1G的带宽，每月1T的流量），当然线路也重要，不然延迟掉包严重
  - 不用备案、可以搭梯子翻墙
  - `Linux`开机占用`100`MB左右，跑个`dotnet`进程也才`300`MB左右
  - `.net framework`的项目也能跑哦，`mono` 、[jexus](https://www.jexus.org/)
  - `SQLServer`数据库已经有`Linux`版本，当然也可以改为`MySql`
  - 上手`Linux`服务器，一脸懵逼，什么都不知道不知从何下手，怎么办，你说怎么办，凉拌，网上有大把的教程，弄懂一个算一个；这里提供一些我用到的东西：
    - ssh命令连接服务器
    - 安装环境：`dotnet`、`nginx`、`ftp`、`mysql`、`frp`（微信开发）、`shadowsocks`（翻墙）
    - 学习`vi`编辑器，学习`dotnet`命令，学习`nginx`配置
    - 存的一些干货 <https://www.netnr.com/gist/user/1>

### [v2.0.0] - 2018-07
- 前端采用 jQuery + Bootstrap + EasyUI + AceAdmin
- 后端采用 Asp.Net Core + EF + SQLServer
- 全新重写 `z.js` 脚本包，与EasyUI提供的API高度保持一致（最大调整）
- 重写iframe选项卡
- 精简ace导航